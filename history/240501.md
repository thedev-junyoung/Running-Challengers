##   이슈 1: Entity와 참조 순환 문제

### **배경**:
- **JPA(자바 퍼시스턴스 API)**는 자바 객체를 데이터베이스 테이블에 매핑하는 기술이다. 이를 통해 데이터베이스에서 가져온 정보를 자바 엔터티 객체로 표현할 수 있다.
- JPA에서는 엔터티 간의 연관 관계를 명확히 표현하기 위해 **객체 참조**를 사용한다. 예를 들어, `Challenge` 엔터티는 `User` 엔터티를 객체 참조로 가져올 수 있다.
- MySQL 데이터베이스에서는 외래 키(Foreign Key)로 이를 관리하며, 객체 참조를 통해 데이터를 처리하는 JPA와는 다르게 외래 키 값만을 컬럼으로 저장한다.

### **문제**:

- JPA에서 엔터티를 설계할 때 연관된 엔터티 객체를 직접 참조하기 때문에 엔터티 간의 순환 참조 문제가 발생할 수 있다.
- 예를 들어 `User` 엔터티가 `Challenge` 엔터티를 참조하고, `Challenge` 엔터티는 `User` 엔터티를 다시 참조하면 순환 참조가 발생하여 무한 루프가 생길 수 있다.

### **이슈 설명**:

- **왜 객체로 참조해야 하는가**: JPA에서 객체 참조를 사용하는 이유는 연관된 엔터티 간의 데이터를 객체 지향적으로 다루기 위함이다. 이렇게 하면 개발자가 객체 간의 관계를 명확히 파악할 수 있고, 이를 통해 데이터 처리 로직을 간소화하고, 데이터 액세스를 직관적으로 수행할 수 있다.

### **해결 방안**:

1. **데이터베이스 설계 변경**: 외래 키를 명시적으로 다루는 것보다 JPA의 객체 참조 방식을 그대로 유지하면서, 서로 참조할 필요가 없는 엔터티에 대해 관계를 없애거나 중간 엔터티를 두어 간접적으로 참조하는 방식도 고려할 수 있다.

2. **Fetch 전략 조정**: JPA에서 `@ManyToOne`, `@OneToMany` 등의 관계를 선언할 때 기본 `FetchType.LAZY`를 활용해 필요할 때만 데이터를 불러오도록 하여 무한 순환을 방지하는 방식이다.

3. **DTO 및 매핑 사용**: 엔터티 간의 순환 참조 문제를 방지하기 위해 필요한 필드만 추출하여 DTO로 정의하고, 이를 엔터티와 분리하여 사용한다.


### **선택한 해결 방안**:

- **DTO 사용 및 매핑**을 선택하여 무한 참조 문제를 해결했다. 엔터티 간에 참조 순환 문제가 발생하지 않도록 DTO에 필요한 필드만 선택하여 반환하며, 이를 통해 데이터 전송 및 조회 시 발생할 수 있는 순환 참조 문제를 방지한다.
- **ModelMapper**를 활용하여 엔터티와 DTO 간의 변환을 자동화하고, 커스텀 매핑을 설정하여 참조 관계를 단순하게 했다.

### **선정 이유**:

- 엔터티 객체 자체를 그대로 사용하면 데이터 전송 시에 불필요한 순환 참조로 인해 문제가 발생할 수 있지만, DTO를 활용해 필요한 필드만 추출해 반환하면 이 문제를 해결할 수 있다.
- DTO와 엔터티 간의 변환을 자동화하면 코드를 간결하게 유지할 수 있으며, 개발 생산성과 가독성을 높일 수 있다.



##   이슈 2: 로깅, Exception을 전역적으로 관리

### **배경**:

- 애플리케이션에서는 여러 컨트롤러 및 서비스 계층에서 다양한 예외가 발생한다. 이러한 예외를 일관성 있게 처리하여 통일된 방식으로 응답을 제공하는 시스템이 필요하다.
- 개발 단계에서의 디버깅 및 프로덕션 환경에서의 오류 진단을 위해서는 효과적인 로깅 시스템이 필수적이다. 로깅 시스템은 예외 발생 시 관련된 정보를 빠르게 파악하여 원인 분석과 문제 해결을 돕는다.

### **선택지**:

1. **메서드별 예외 처리**: 각 메서드에서 자체적으로 예외 처리를 수행한다. 예외 발생 시마다 개별 로직으로 처리하며, 상황에 따라 다른 처리가 필요한 경우 유연하게 대처할 수 있다.

    - **장점**: 유연한 처리 가능, 각 메서드에 특화된 예외 처리 제공
    - **단점**: 중복 코드 발생, 예외 처리가 일관성 없이 분산
2. **@ControllerAdvice 사용**: 전역적인 예외 처리 핸들러를 정의하여 모든 컨트롤러에서 발생하는 예외를 통일된 방식으로 처리한다.

    - **장점**: 중복 코드 없이 일관된 예외 처리 가능, 유지보수 용이
    - **단점**: 전역 핸들러만 사용하면 예외 처리가 유연하지 않을 수 있다
3. **AOP(Aspect-Oriented Programming) 사용**: 횡단 관심사를 통해 예외 발생 시 로깅을 수행한다. 예외가 발생하면 관련 정보와 예외 스택을 로그에 기록하여 진단에 활용할 수 있다.

    - **장점**: 비즈니스 로직과 로깅 로직 분리, 다양한 로그 수집 가능
    - **단점**: 추가적인 코드가 필요하며, 설정이 다소 복잡할 수 있다

### **해결 방안**:

- **@ControllerAdvice**를 사용하여 모든 컨트롤러에서 발생하는 예외를 전역적으로 처리하고, 공통된 응답을 제공한다. 예외 타입에 따라 다양한 응답 코드를 제공하고, 사용자에게 명확한 에러 메시지를 전달한다.
- **AOP**를 통해 모든 메서드에서 발생하는 예외를 로깅하며, 추가적인 정보나 예외의 원인을 파악할 수 있는 힌트를 제공한다.

### **선정 이유**:

- **@ControllerAdvice**를 통해 일관된 예외 처리를 적용하여 유지보수를 단순화할 수 있다. 예외 처리 코드를 메서드에서 분리해 코드의 간결성과 가독성을 높인다.
- **AOP**를 통해 예외 발생 시 추가적인 로깅을 수행하여, 문제의 원인을 빠르게 파악하고 추적할 수 있도록 지원한다. 이는 서비스 안정성을 높이고, 시스템의 가시성을 높인다.
